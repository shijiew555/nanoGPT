--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  aten::mm         2.55%        1.996s        34.43%       26.926s     457.158us       38.269s        46.31%       38.269s     649.757us         58898  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               aten::copy_         1.05%     821.880ms        19.13%       14.964s     209.681us       12.137s        14.69%       12.137s     170.071us         71367  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ampere_bf16_s16816gemm_bf16_128x128_ldg8_f2f_stages_32x5_tn         0.00%       0.000us         0.00%       0.000us       0.000us       10.653s        12.89%       10.653s     716.248us         14874  
    void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#12}::operator()() const::{lambda(c10::BFloat16)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#12}::operator()() const::{lambda(c10::BFloat16)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)         0.00%       0.000us         0.00%       0.000us       0.000us        6.693s         8.10%        6.693s     163.455us         40948  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ampere_bf16_s16816gemm_bf16_256x128_ldg8_f2f_stages_64x3_nt         0.00%       0.000us         0.00%       0.000us       0.000us        6.123s         7.41%        6.123s       1.178ms          5200  
                      void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)         0.00%       0.000us         0.00%       0.000us       0.000us        5.424s         6.56%        5.424s     173.813us         31208  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          aten::native_layer_norm_backward         0.26%     203.425ms         3.69%        2.888s     288.812us        4.655s         5.63%        4.655s     465.505us         10000  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ampere_bf16_s16816gemm_bf16_128x256_ldg8_f2f_stages_64x3_nt         0.00%       0.000us         0.00%       0.000us       0.000us        4.649s         5.63%        4.649s     484.268us          9600  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           aten::_flash_attention_backward         0.23%     176.832ms         2.48%        1.940s     404.078us        4.591s         5.56%        4.591s     956.423us          4800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          aten::_log_softmax_backward_data         0.01%       6.809ms         0.01%      10.846ms      27.115us        3.872s         4.69%        3.872s       9.680ms           400  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     void at::native::(anonymous namespace)::cunn_SoftMaxBackward<8, c10::BFloat16, float, c10::BFloat16, at::native::(anonymous namespace)::LogSoftMaxBackwardEpilogue>(c10::BFloat16*, c10::BFloat16 const*, c10::BFloat16 const*, long)         0.00%       0.000us         0.00%       0.000us       0.000us        3.872s         4.69%        3.872s       9.680ms           400  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ampere_bf16_s16816gemm_bf16_128x128_ldg8_f2f_stages_32x5_nn         0.00%       0.000us         0.00%       0.000us       0.000us        3.872s         4.68%        3.872s     403.289us          9600  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ampere_bf16_s16816gemm_bf16_256x128_ldg8_f2f_stages_64x3_nn         0.00%       0.000us         0.00%       0.000us       0.000us        3.568s         4.32%        3.568s       8.919ms           400  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        aten::_log_softmax         0.02%      12.494ms         0.14%     109.080ms     271.344us        3.255s         3.94%        3.255s       8.097ms           402  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              void at::native::(anonymous namespace)::cunn_SoftMaxForward<8, c10::BFloat16, float, c10::BFloat16, at::native::(anonymous namespace)::LogSoftMaxForwardEpilogue>(c10::BFloat16*, c10::BFloat16 const*, int)         0.00%       0.000us         0.00%       0.000us       0.000us        3.255s         3.94%        3.255s       8.097ms           402  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ampere_bf16_s16816gemm_bf16_128x256_ldg8_f2f_stages_64x3_tn         0.00%       0.000us         0.00%       0.000us       0.000us        3.146s         3.81%        3.146s     652.060us          4824  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ampere_bf16_s16816gemm_bf16_128x256_ldg8_f2f_stages_64x3_nn         0.00%       0.000us         0.00%       0.000us       0.000us        3.120s         3.78%        3.120s     649.964us          4800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                  void pytorch_flash::flash_bwd_dq_dk_dv_loop_seqk_parallel_kernel<pytorch_flash::Flash_bwd_kernel_traits<64, 128, 128, 8, 4, 4, 4, false, false, cutlass::bfloat16_t, pytorch_flash::Flash_kernel_traits<64, 128, 128, 8, cutlass::bfloat16_t> >, false, true, false, false, true, true>(pytorch_flash::Flash_bwd_params)         0.00%       0.000us         0.00%       0.000us       0.000us        3.114s         3.77%        3.114s     648.782us          4800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                aten::add_         0.51%     398.993ms        13.96%       10.919s     278.195us        2.528s         3.06%        2.528s      64.408us         39250  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 void at::native::vectorized_elementwise_kernel<4, at::native::CUDAFunctor_add<float>, at::detail::Array<char*, 3> >(int, at::native::CUDAFunctor_add<float>, at::detail::Array<char*, 3>)         0.00%       0.000us         0.00%       0.000us       0.000us        2.528s         3.06%        2.528s      64.408us         39250  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ampere_bf16_s16816gemm_bf16_256x128_ldg8_f2f_stages_32x3_nn         0.00%       0.000us         0.00%       0.000us       0.000us        2.383s         2.88%        2.383s     496.559us          4800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               void at::native::(anonymous namespace)::GammaBetaBackwardCUDAKernel_32x32<float, float>(long, long, float const*, float const*, float const*, float const*, float*, float*)         0.00%       0.000us         0.00%       0.000us       0.000us        2.364s         2.86%        2.364s     236.449us         10000  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          void at::native::(anonymous namespace)::layer_norm_grad_input_kernel_vectorized<float, float>(float const*, float const*, float const*, float const*, float const*, float*, int)         0.00%       0.000us         0.00%       0.000us       0.000us        2.291s         2.77%        2.291s     229.056us         10000  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       aten::gelu_backward         0.12%      93.823ms         1.91%        1.493s     311.057us        2.186s         2.65%        2.186s     455.405us          4800  
                                                                                                                                                                                                                                               void at::native::vectorized_elementwise_kernel<4, at::native::GeluBackwardCUDAKernelImpl(at::TensorIteratorBase&, at::native::GeluType)::{lambda()#2}::operator()() const::{lambda()#4}::operator()() const::{lambda(c10::BFloat16, c10::BFloat16)#1}, at::detail::Array<char*, 3> >(int, at::native::GeluBackwardCUDAKernelImpl(at::TensorIteratorBase&, at::native::GeluType)::{lambda()#2}::operator()() const::{lambda()#4}::operator()() const::{lambda(c10::BFloat16, c10::BFloat16)#1}, at::detail::Array<char*, 3>)         0.00%       0.000us         0.00%       0.000us       0.000us        2.186s         2.65%        2.186s     455.405us          4800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 aten::add         0.60%     471.987ms         2.06%        1.613s      14.243us        1.972s         2.39%        1.972s      17.420us        113228  
                                                                                                                                                                                                                                                        void at::native::unrolled_elementwise_kernel<at::native::CUDAFunctor_add<float>, at::detail::Array<char*, 3>, TrivialOffsetCalculator<2, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<2>, at::native::memory::StoreWithCast<1> >(int, at::native::CUDAFunctor_add<float>, at::detail::Array<char*, 3>, TrivialOffsetCalculator<2, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<2>, at::native::memory::StoreWithCast<1>)         0.00%       0.000us         0.00%       0.000us       0.000us        1.910s         2.31%        1.910s     197.920us          9648  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               aten::fill_         0.03%      23.653ms         0.09%      71.765ms      39.066us        1.744s         2.11%        1.744s     949.329us          1837  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         void at::native::vectorized_elementwise_kernel<4, at::native::FillFunctor<float>, at::detail::Array<char*, 1> >(int, at::native::FillFunctor<float>, at::detail::Array<char*, 1>)         0.00%       0.000us         0.00%       0.000us       0.000us        1.744s         2.11%        1.744s     574.602us          3035  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 aten::cat         0.36%     284.266ms         1.45%        1.131s     201.393us        1.734s         2.10%        1.734s     308.764us          5616  
                                                                                                                                                                                                                                                                                                                                       void at::native::(anonymous namespace)::CatArrayBatchedCopy_contig<at::native::(anonymous namespace)::OpaqueType<2u>, unsigned int, 3, 128, 1>(at::native::(anonymous namespace)::OpaqueType<2u>*, at::native::(anonymous namespace)::CatArrInputTensorMetadata<at::native::(anonymous namespace)::OpaqueType<2u>, unsigned int, 128, 1>, at::native::(anonymous namespace)::TensorSizeStride<unsigned int, 4u>, int, unsigned int)         0.00%       0.000us         0.00%       0.000us       0.000us        1.734s         2.10%        1.734s     361.247us          4800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   aten::native_layer_norm         0.43%     333.123ms         2.50%        1.954s     194.477us        1.664s         2.01%        1.664s     165.593us         10050  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          void at::native::(anonymous namespace)::vectorized_layer_norm_kernel<float, float>(int, float, float const*, float const*, float const*, float*, float*, float*)         0.00%       0.000us         0.00%       0.000us       0.000us        1.664s         2.01%        1.664s     165.593us         10050  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                aten::gelu         0.15%     113.951ms         0.99%     775.719ms     160.804us        1.509s         1.83%        1.509s     312.798us          4824  
                                                                                                                                                                                                                                                                                             void at::native::vectorized_elementwise_kernel<4, at::native::GeluCUDAKernelImpl(at::TensorIteratorBase&, at::native::GeluType)::{lambda()#2}::operator()() const::{lambda()#4}::operator()() const::{lambda(c10::BFloat16)#1}, at::detail::Array<char*, 2> >(int, at::native::GeluCUDAKernelImpl(at::TensorIteratorBase&, at::native::GeluType)::{lambda()#2}::operator()() const::{lambda()#4}::operator()() const::{lambda(c10::BFloat16)#1}, at::detail::Array<char*, 2>)         0.00%       0.000us         0.00%       0.000us       0.000us        1.509s         1.83%        1.509s     312.798us          4824  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            aten::_flash_attention_forward         0.17%     132.413ms         0.75%     584.721ms     121.211us        1.313s         1.59%        1.313s     272.113us          4824  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                void pytorch_flash::flash_fwd_kernel<pytorch_flash::Flash_fwd_kernel_traits<64, 128, 128, 4, false, false, cutlass::bfloat16_t, pytorch_flash::Flash_kernel_traits<64, 128, 128, 4, cutlass::bfloat16_t> >, false, true, false, false, true, true, false>(pytorch_flash::Flash_fwd_params)         0.00%       0.000us         0.00%       0.000us       0.000us        1.313s         1.59%        1.313s     272.113us          4824  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     void pytorch_flash::flash_bwd_dot_do_o_kernel<true, pytorch_flash::Flash_bwd_kernel_traits<64, 128, 128, 8, 4, 4, 4, false, false, cutlass::bfloat16_t, pytorch_flash::Flash_kernel_traits<64, 128, 128, 8, cutlass::bfloat16_t> > >(pytorch_flash::Flash_bwd_params)         0.00%       0.000us         0.00%       0.000us       0.000us     869.035ms         1.05%     869.035ms     181.049us          4800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ampere_bf16_s16816gemm_bf16_128x128_ldg8_f2f_stages_64x3_nt         0.00%       0.000us         0.00%       0.000us       0.000us     693.142ms         0.84%     693.142ms     144.405us          4800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void pytorch_flash::flash_bwd_convert_dq_kernel<pytorch_flash::Flash_bwd_kernel_traits<64, 128, 128, 8, 4, 4, 4, false, false, cutlass::bfloat16_t, pytorch_flash::Flash_kernel_traits<64, 128, 128, 8, cutlass::bfloat16_t> > >(pytorch_flash::Flash_bwd_params, int)         0.00%       0.000us         0.00%       0.000us       0.000us     607.645ms         0.74%     607.645ms     126.593us          4800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    aten::nll_loss_forward         0.02%      12.783ms         0.27%     213.714ms     531.626us     480.971ms         0.58%     480.971ms       1.196ms           402  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 void at::native::(anonymous namespace)::nll_loss_forward_reduce_cuda_kernel_2d<float, float, long>(float*, float*, float const*, long const*, float const*, bool, long, long, long, long)         0.00%       0.000us         0.00%       0.000us       0.000us     480.971ms         0.58%     480.971ms       1.196ms           402  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            aten::embedding_dense_backward         0.09%      73.986ms         3.64%        2.844s       3.555ms     293.694ms         0.36%     335.267ms     419.083us           800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   aten::nll_loss_backward         0.01%       9.555ms         0.06%      48.435ms     121.088us     249.116ms         0.30%        1.951s       4.877ms           400  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   void at::native::(anonymous namespace)::nll_loss_backward_reduce_cuda_kernel_2d<float, long>(float*, float const*, long const*, float const*, float const*, bool, int, int, long, long)         0.00%       0.000us         0.00%       0.000us       0.000us     249.116ms         0.30%     249.116ms     622.790us           400  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             void at::native::(anonymous namespace)::sum_and_scatter<float, long>(long const*, float*, long, long const*, long const*, at::AccumulateType<float, true>::type const*, long const*, long const*, long, long)         0.00%       0.000us         0.00%       0.000us       0.000us     129.990ms         0.16%     129.990ms     324.975us           400  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        aten::index_select         0.03%      20.758ms         0.74%     582.153ms     724.071us     107.948ms         0.13%     107.948ms     134.264us           804  
                                                                                                                                                                                                                                                                                                                                                                                                                                                  void at::native::(anonymous namespace)::indexSelectLargeIndex<float, long, unsigned int, 2, 2, -2, true>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float const, unsigned int>, at::cuda::detail::TensorInfo<long const, unsigned int>, int, int, unsigned int, unsigned int, long)         0.00%       0.000us         0.00%       0.000us       0.000us     107.948ms         0.13%     107.948ms     134.264us           804  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      void at::native::(anonymous namespace)::compute_grad_weight<float, long>(long const*, float const*, long const*, long, long, long const*, long const*, at::AccumulateType<float, true>::type*, long)         0.00%       0.000us         0.00%       0.000us       0.000us      90.353ms         0.11%      90.353ms     225.883us           400  
                                                                                                                                                                                                                                                                                                                                                                                              void at::native::elementwise_kernel<128, 2, at::native::gpu_kernel_impl_nocast<at::native::CUDAFunctor_add<float> >(at::TensorIteratorBase&, at::native::CUDAFunctor_add<float> const&)::{lambda(int)#1}>(int, at::native::gpu_kernel_impl_nocast<at::native::CUDAFunctor_add<float> >(at::TensorIteratorBase&, at::native::CUDAFunctor_add<float> const&)::{lambda(int)#1})         0.00%       0.000us         0.00%       0.000us       0.000us      62.892ms         0.08%      62.892ms     156.448us           402  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Optimizer.step#AdamW.step         0.00%       0.000us         0.00%       0.000us       0.000us      43.427ms         0.05%      43.427ms       4.343ms            10  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us      37.392ms         0.05%      37.392ms       1.989us         18800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 aten::sum         0.02%      12.866ms         0.10%      79.040ms     196.618us      35.771ms         0.04%      35.771ms      88.983us           402  
                                                                                                                                                                                                                                                                                                                                 void at::native::reduce_kernel<128, 4, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)         0.00%       0.000us         0.00%       0.000us       0.000us      35.771ms         0.04%      35.771ms      89.428us           400  
                                                                                                                                                                                                                                                                                                                                                                                                                                                   void splitKreduce_kernel<32, 16, int, __nv_bfloat16, __nv_bfloat16, float, __nv_bfloat16, true, false, false>(cublasSplitKParams<float>, __nv_bfloat16 const*, __nv_bfloat16 const*, __nv_bfloat16*, float const*, float const*, __nv_bfloat16 const*, __nv_bfloat16 const*, __nv_bfloat16*, void*, long, float*, int*)         0.00%       0.000us         0.00%       0.000us       0.000us      33.157ms         0.04%      33.157ms       6.908us          4800  
                                                                                                                                                                                                                                                                                                                        void at_cuda_detail::cub::DeviceRadixSortOnesweepKernel<at_cuda_detail::cub::DeviceRadixSortPolicy<long, at::cuda::cub::detail::OpaqueType<8>, unsigned long long>::Policy800, false, long, at::cuda::cub::detail::OpaqueType<8>, unsigned long long, int, int>(int*, int*, unsigned long long*, unsigned long long const*, long*, long const*, at::cuda::cub::detail::OpaqueType<8>*, at::cuda::cub::detail::OpaqueType<8> const*, int, int, int)         0.00%       0.000us         0.00%       0.000us       0.000us      32.921ms         0.04%      32.921ms      10.288us          3200  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       aten::_fused_adamw_         0.00%     825.503us         0.02%      14.256ms     712.775us      27.394ms         0.03%      27.394ms       1.370ms            20  
                                                                                                                                                                 void at::native::(anonymous namespace)::multi_tensor_apply_kernel<at::native::(anonymous namespace)::FusedOptimizerTensorListMetadata<4>, at::native::(anonymous namespace)::FusedAdamMathFunctor<float, 4, (at::native::ADAM_MODE)1, false>, float const*, double, double, double, double, double, bool, float const*, float const*>(at::native::(anonymous namespace)::FusedOptimizerTensorListMetadata<4>, at::native::(anonymous namespace)::FusedAdamMathFunctor<float, 4, (at::native::ADAM_MODE)1, false>, float const*, double, double, double, double, double, bool, float const*, float const*)         0.00%       0.000us         0.00%       0.000us       0.000us      27.394ms         0.03%      27.394ms     391.340us            70  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Memcpy HtoD (Pinned -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      19.952ms         0.02%      19.952ms      24.754us           806  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           cudaEventRecord         0.00%       2.801ms         0.00%       2.801ms       3.476us      19.707ms         0.02%      19.707ms      24.451us           806  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       void at::native::(anonymous namespace)::krn_partial_segment_offset<long>(long*, long const*, long const*, long const*, long const*)         0.00%       0.000us         0.00%       0.000us       0.000us      10.406ms         0.01%      10.406ms      26.014us           400  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          void at::native::(anonymous namespace)::embedding_backward_feature_kernel<float, float, long>(long const*, float const*, float*, int, long, int)         0.00%       0.000us         0.00%       0.000us       0.000us       9.894ms         0.01%       9.894ms      24.735us           400  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       aten::_foreach_mul_         0.00%     617.382us         0.01%       8.931ms     893.090us       7.742ms         0.01%       7.742ms     774.150us            10  
                                                                                                                                                                                                                                                                                                                                       void at::native::(anonymous namespace)::multi_tensor_apply_kernel<at::native::(anonymous namespace)::TensorListMetadata<1>, at::native::(anonymous namespace)::BinaryOpScalarTensorFunctor<float, 1, 1, 0>, std::multiplies<float>, float*, float>(at::native::(anonymous namespace)::TensorListMetadata<1>, at::native::(anonymous namespace)::BinaryOpScalarTensorFunctor<float, 1, 1, 0>, std::multiplies<float>, float*, float)         0.00%       0.000us         0.00%       0.000us       0.000us       7.742ms         0.01%       7.742ms     129.025us            60  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       aten::_foreach_norm         0.00%       3.887ms         0.34%     268.375ms      26.838ms       4.037ms         0.00%       4.060ms     406.002us            10  
                                                                                                                                                                                                                                                                                                                                                                                                     void at::native::(anonymous namespace)::multi_tensor_apply_kernel<at::native::(anonymous namespace)::TensorListMetadata<1>, at::native::LpNormFunctor<float, (at::native::NormType)1, float, 1, 1, 0>, float*, int>(at::native::(anonymous namespace)::TensorListMetadata<1>, at::native::LpNormFunctor<float, (at::native::NormType)1, float, 1, 1, 0>, float*, int)         0.00%       0.000us         0.00%       0.000us       0.000us       3.990ms         0.00%       3.990ms      66.495us            60  
                                                                                                                                                                                                 void at_cuda_detail::cub::DeviceUniqueByKeySweepKernel<at_cuda_detail::cub::DeviceUniqueByKeyPolicy<long const*>::Policy520, long const*, thrust::counting_iterator<int, thrust::use_default, thrust::use_default, thrust::use_default>, long*, long*, long*, at_cuda_detail::cub::ScanTileState<int, true>, at_cuda_detail::cub::Equality, int>(long const*, thrust::counting_iterator<int, thrust::use_default, thrust::use_default, thrust::use_default>, long*, long*, long*, at_cuda_detail::cub::ScanTileState<int, true>, at_cuda_detail::cub::Equality, int, int)         0.00%       0.000us         0.00%       0.000us       0.000us       2.609ms         0.00%       2.609ms       6.523us           400  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          void at_cuda_detail::cub::DeviceRadixSortHistogramKernel<at_cuda_detail::cub::DeviceRadixSortPolicy<long, at::cuda::cub::detail::OpaqueType<8>, unsigned long long>::Policy800, false, long, unsigned long long>(unsigned long long*, long const*, unsigned long long, int, int)         0.00%       0.000us         0.00%       0.000us       0.000us       2.231ms         0.00%       2.231ms       5.578us           400  
                                                                                                                                                                                                                                                                                         void at_cuda_detail::cub::DeviceScanKernel<at_cuda_detail::cub::DeviceScanPolicy<long>::Policy600, long const*, long*, at_cuda_detail::cub::ScanTileState<long, true>, at::cuda::cub::(anonymous namespace)::SumOp<long>, at_cuda_detail::cub::detail::InputValue<long, long*>, int, long>(long const*, long*, at_cuda_detail::cub::ScanTileState<long, true>, int, at::cuda::cub::(anonymous namespace)::SumOp<long>, at_cuda_detail::cub::detail::InputValue<long, long*>, int)         0.00%       0.000us         0.00%       0.000us       0.000us       2.073ms         0.00%       2.073ms       5.182us           400  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 aten::div         0.04%      30.308ms         0.24%     185.190ms     231.488us       1.902ms         0.00%       1.902ms       2.377us           800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                       void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, float, at::native::binary_internal::MulFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, float, at::native::binary_internal::MulFunctor<float> >, at::detail::Array<char*, 2>)         0.00%       0.000us         0.00%       0.000us       0.000us       1.902ms         0.00%       1.902ms       2.377us           800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              aten::arange         0.03%      23.933ms         0.19%     146.538ms      91.358us       1.848ms         0.00%       3.695ms       2.304us          1604  
                                                                                    void (anonymous namespace)::elementwise_kernel_with_index<int, at::native::arange_cuda_out(c10::Scalar const&, c10::Scalar const&, c10::Scalar const&, at::Tensor&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(long)#1}>(int, at::native::arange_cuda_out(c10::Scalar const&, c10::Scalar const&, c10::Scalar const&, at::Tensor&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(long)#1}, function_traits<at::native::arange_cuda_out(c10::Scalar const&, c10::Scalar const&, c10::Scalar const&, at::Tensor&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(long)#1}>::result_type*)         0.00%       0.000us         0.00%       0.000us       0.000us       1.848ms         0.00%       1.848ms       2.304us           802  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             void at::native::(anonymous namespace)::krn_partials_per_segment<long>(long*, long const*, long const*, long)         0.00%       0.000us         0.00%       0.000us       0.000us       1.176ms         0.00%       1.176ms       2.941us           400  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        void at_cuda_detail::cub::DeviceCompactInitKernel<at_cuda_detail::cub::ScanTileState<int, true>, long*>(at_cuda_detail::cub::ScanTileState<int, true>, int, long*)         0.00%       0.000us         0.00%       0.000us       0.000us       1.008ms         0.00%       1.008ms       2.519us           400  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               void at_cuda_detail::cub::DeviceRadixSortExclusiveSumKernel<at_cuda_detail::cub::DeviceRadixSortPolicy<long, at::cuda::cub::detail::OpaqueType<8>, unsigned long long>::Policy800, unsigned long long>(unsigned long long*)         0.00%       0.000us         0.00%       0.000us       0.000us     994.618us         0.00%     994.618us       2.487us           400  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               void at::native::(anonymous namespace)::compute_num_of_partial_segments<long>(long const*, long const*, long const*, long*)         0.00%       0.000us         0.00%       0.000us       0.000us     917.412us         0.00%     917.412us       2.294us           400  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      void at_cuda_detail::cub::DeviceScanInitKernel<at_cuda_detail::cub::ScanTileState<long, true> >(at_cuda_detail::cub::ScanTileState<long, true>, int)         0.00%       0.000us         0.00%       0.000us       0.000us     737.153us         0.00%     737.153us       1.843us           400  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       aten::_foreach_add_         0.00%       1.449ms         0.02%      14.012ms     700.617us      80.031us         0.00%      80.031us       4.002us            20  
                                                                                                                                                                                                                                                                                                                                                                               void at::native::(anonymous namespace)::multi_tensor_apply_kernel<at::native::(anonymous namespace)::TensorListMetadata<1>, at::native::(anonymous namespace)::BinaryOpScalarFunctor<float, 1, 1, 0>, std::plus<float>, float>(at::native::(anonymous namespace)::TensorListMetadata<1>, at::native::(anonymous namespace)::BinaryOpScalarFunctor<float, 1, 1, 0>, std::plus<float>, float)         0.00%       0.000us         0.00%       0.000us       0.000us      80.031us         0.00%      80.031us       4.002us            20  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  aten::linalg_vector_norm         0.00%     595.960us         0.04%      30.467ms       3.047ms      48.607us         0.00%      48.607us       4.861us            10  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::NormTwoOps<float, float, float>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::NormTwoOps<float, float, float>, unsigned int, float, 4>)         0.00%       0.000us         0.00%       0.000us       0.000us      48.607us         0.00%      48.607us       4.861us            10  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         void at::native::lpnorm_cleanup<float, (at::native::NormType)1, float, float>(float const*, at::native::TensorListAddresses, int)         0.00%       0.000us         0.00%       0.000us       0.000us      46.814us         0.00%      46.814us       4.681us            10  
                                                                                                                                                                                                                                                                                                                             void at::native::(anonymous namespace)::CatArrayBatchedCopy_aligned16_contig<at::native::(anonymous namespace)::OpaqueType<4u>, unsigned int, 1, 128, 1>(at::native::(anonymous namespace)::OpaqueType<4u>*, at::native::(anonymous namespace)::CatArrInputTensorMetadata<at::native::(anonymous namespace)::OpaqueType<4u>, unsigned int, 128, 1>, at::native::(anonymous namespace)::TensorSizeStride<unsigned int, 4u>, int, unsigned int)         0.00%       0.000us         0.00%       0.000us       0.000us      35.261us         0.00%      35.261us       3.526us            10  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               aten::clamp         0.00%     335.257us         0.03%      20.318ms       2.032ms      24.353us         0.00%      24.353us       2.435us            10  
                                                                                                                                                                                   void at::native::vectorized_elementwise_kernel<4, at::native::(anonymous namespace)::launch_clamp_scalar(at::TensorIteratorBase&, c10::Scalar, c10::Scalar, at::native::detail::ClampLimits)::{lambda()#1}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2> >(int, at::native::(anonymous namespace)::launch_clamp_scalar(at::TensorIteratorBase&, c10::Scalar, c10::Scalar, at::native::detail::ClampLimits)::{lambda()#1}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>)         0.00%       0.000us         0.00%       0.000us       0.000us      24.353us         0.00%      24.353us       2.435us            10  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     void at::native::vectorized_elementwise_kernel<4, at::native::CUDAFunctorOnSelf_add<float>, at::detail::Array<char*, 2> >(int, at::native::CUDAFunctorOnSelf_add<float>, at::detail::Array<char*, 2>)         0.00%       0.000us         0.00%       0.000us       0.000us      22.879us         0.00%      22.879us       2.288us            10  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 aten::mul         0.00%     267.497us         0.01%       9.257ms     925.672us      22.754us         0.00%      22.754us       2.275us            10  
                                                                                                                                                                                                                                                                                                                                                                                                                                                       void at::native::vectorized_elementwise_kernel<4, at::native::AUnaryFunctor<float, float, float, at::native::binary_internal::MulFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::AUnaryFunctor<float, float, float, at::native::binary_internal::MulFunctor<float> >, at::detail::Array<char*, 2>)         0.00%       0.000us         0.00%       0.000us       0.000us      22.754us         0.00%      22.754us       2.275us            10  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          aten::reciprocal         0.00%     289.409us         0.02%      13.000ms       1.300ms      22.402us         0.00%      22.402us       2.240us            10  
                                                                                                                                                                                                                                                                                                                                                 void at::native::vectorized_elementwise_kernel<4, at::native::reciprocal_kernel_cuda(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#2}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2> >(int, at::native::reciprocal_kernel_cuda(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#2}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>)         0.00%       0.000us         0.00%       0.000us       0.000us      22.402us         0.00%      22.402us       2.240us            10  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 aten::_local_scalar_dense         0.04%      27.408ms         0.12%      90.293ms       0.875us      11.488us         0.00%      11.488us       0.000us        103176  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Memcpy DtoH (Device -> Pinned)         0.00%       0.000us         0.00%       0.000us       0.000us      11.488us         0.00%      11.488us       3.829us             3  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             aten::randint         0.01%       4.620ms         0.02%      12.084ms      29.986us       0.000us         0.00%       0.000us       0.000us           403  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               aten::empty         0.78%     610.277ms         0.78%     611.487ms       7.148us       0.000us         0.00%       0.000us       0.000us         85542  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             aten::random_         0.01%       5.124ms         0.01%       5.124ms      12.716us       0.000us         0.00%       0.000us       0.000us           403  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              aten::unbind         0.10%      76.135ms         0.26%     204.556ms     253.791us       0.000us         0.00%       0.000us       0.000us           806  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              aten::select         0.13%     100.559ms         0.16%     128.483ms       2.491us       0.000us         0.00%       0.000us       0.000us         51586  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          aten::as_strided         0.38%     297.549ms         0.38%     297.549ms       1.136us       0.000us         0.00%       0.000us       0.000us        261916  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                aten::item         0.14%     107.961ms         0.25%     198.253ms       1.922us       0.000us         0.00%      11.488us       0.000us        103176  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          aten::lift_fresh         0.02%      18.661ms         0.02%      18.661ms       0.362us       0.000us         0.00%       0.000us       0.000us         51586  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               aten::stack         0.02%      19.064ms         0.23%     178.605ms     218.878us       0.000us         0.00%      35.261us       0.043us           816  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              aten::narrow         0.06%      47.273ms         0.15%     114.154ms       7.472us       0.000us         0.00%       0.000us       0.000us         15278  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               aten::slice         0.06%      50.406ms         0.09%      66.881ms       4.378us       0.000us         0.00%       0.000us       0.000us         15278  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                aten::view         0.49%     383.897ms         0.49%     383.897ms       3.159us       0.000us         0.00%       0.000us       0.000us        121508  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          aten::pin_memory         0.01%       4.088ms         0.10%      80.061ms      99.332us       0.000us         0.00%       0.000us       0.000us           806  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           aten::is_pinned         0.02%      13.441ms         0.02%      18.416ms      22.849us       0.000us         0.00%       0.000us       0.000us           806  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  cudaPointerGetAttributes         0.01%       4.975ms         0.01%       4.975ms       6.173us       0.000us         0.00%       0.000us       0.000us           806  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         aten::_pin_memory         0.02%      12.572ms         0.07%      57.557ms      71.411us       0.000us         0.00%       0.000us       0.000us           806  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             cudaHostAlloc         0.00%       1.341ms         0.00%       1.341ms     268.152us       0.000us         0.00%       0.000us       0.000us             5  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                aten::set_         0.00%       1.698ms         0.00%       1.698ms       2.106us       0.000us         0.00%       0.000us       0.000us           806  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  aten::to         0.21%     164.667ms        20.92%       16.358s     228.051us       0.000us         0.00%       12.137s     169.208us         71731  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            aten::_to_copy         0.79%     616.863ms        20.70%       16.194s     229.505us       0.000us         0.00%       12.137s     172.018us         70559  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       aten::empty_strided         1.01%     789.045ms         1.03%     809.489ms       8.961us       0.000us         0.00%       0.000us       0.000us         90333  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           cudaMemcpyAsync         0.02%      17.334ms         0.02%      17.334ms      21.426us       0.000us         0.00%       0.000us       0.000us           809  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            cudaEventQuery         0.01%       6.128ms         0.01%       6.128ms       3.839us       0.000us         0.00%       0.000us       0.000us          1596  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               aten::zeros         0.01%       6.735ms         0.07%      51.249ms      57.778us       0.000us         0.00%      40.764ms      45.957us           887  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               aten::zero_         0.01%       8.719ms         0.08%      60.285ms      41.952us       0.000us         0.00%        1.743s       1.213ms          1437  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             aten::resize_         0.01%      11.047ms         0.01%      11.337ms       5.646us       0.000us         0.00%       0.000us       0.000us          2008  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          cudaLaunchKernel        70.56%       55.187s        70.56%       55.187s     208.585us       0.000us         0.00%       0.000us       0.000us        264577  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           aten::embedding         0.02%      16.131ms         0.77%     601.790ms     748.495us       0.000us         0.00%     107.948ms     134.264us           804  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             aten::reshape         0.23%     179.357ms         0.60%     467.235ms       5.922us       0.000us         0.00%       0.000us       0.000us         78900  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     cudaStreamIsCapturing         0.02%      12.026ms         0.02%      12.026ms       2.478us       0.000us         0.00%       0.000us       0.000us          4853  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                cudaMalloc         0.06%      44.925ms         0.06%      44.925ms       1.797ms       0.000us         0.00%       0.000us       0.000us            25  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             aten::dropout         0.01%       7.595ms         0.01%       7.595ms       0.756us       0.000us         0.00%       0.000us       0.000us         10050  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          aten::layer_norm         0.09%      70.153ms         2.59%        2.025s     201.458us       0.000us         0.00%        1.664s     165.593us         10050  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              aten::linear         0.28%     221.978ms        17.19%       13.443s     341.222us       0.000us         0.00%       29.382s     745.803us         39396  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   aten::t         0.47%     365.567ms         1.11%     865.159ms       8.819us       0.000us         0.00%       0.000us       0.000us         98098  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           aten::transpose         0.85%     664.586ms         1.17%     917.213ms       4.721us       0.000us         0.00%       0.000us       0.000us        194290  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              aten::matmul         0.24%     188.373ms         5.35%        4.184s     212.405us       0.000us         0.00%       13.799s     700.528us         19698  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  cudaFree         0.02%      18.040ms         0.02%      18.040ms       6.013ms       0.000us         0.00%       0.000us       0.000us             3  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    cudaDeviceGetAttribute         0.01%       9.107ms         0.01%       9.107ms       1.336us       0.000us         0.00%       0.000us       0.000us          6815  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      cudaGetSymbolAddress         0.00%     182.818us         0.00%     182.818us     182.818us       0.000us         0.00%       0.000us       0.000us             1  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      cudaFuncSetAttribute         0.14%     105.632ms         0.14%     105.632ms      10.525us       0.000us         0.00%       0.000us       0.000us         10036  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             cudaOccupancyMaxActiveBlocksPerMultiprocessor         0.13%     105.488ms         0.13%     105.488ms       1.949us       0.000us         0.00%       0.000us       0.000us         54113  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        aten::_unsafe_view         0.10%      81.805ms         0.10%      81.805ms       4.153us       0.000us         0.00%       0.000us       0.000us         19698  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               aten::split         0.08%      63.859ms         0.21%     167.521ms      34.727us       0.000us         0.00%       0.000us       0.000us          4824  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        aten::scaled_dot_product_attention         0.13%      98.314ms         1.11%     868.388ms     180.014us       0.000us         0.00%        1.313s     272.113us          4824  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 aten::_scaled_dot_product_flash_attention         0.16%     121.829ms         0.98%     770.074ms     159.634us       0.000us         0.00%        1.313s     272.113us          4824  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          aten::empty_like         0.10%      81.524ms         0.32%     248.488ms      12.078us       0.000us         0.00%       0.000us       0.000us         20574  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  aten::cross_entropy_loss         0.01%       4.246ms         0.65%     509.658ms       1.268ms       0.000us         0.00%        7.406s      18.423ms           402  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         aten::log_softmax         0.01%       3.997ms         0.14%     113.345ms     281.953us       0.000us         0.00%        3.255s       8.097ms           402  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         aten::nll_loss_nd         0.00%       1.946ms         0.50%     392.067ms     975.290us       0.000us         0.00%        4.151s      10.326ms           402  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            aten::nll_loss         0.01%       4.433ms         0.77%     605.723ms     753.387us       0.000us         0.00%        4.632s       5.761ms           804  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     cudaStreamSynchronize         0.08%      62.759ms         0.08%      62.759ms      20.920ms       0.000us         0.00%       0.000us       0.000us             3  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                aten::mean         0.00%      62.161us         0.00%     244.954us     122.477us       0.000us         0.00%       0.000us       0.000us             2  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                aten::div_         0.00%      71.453us         0.00%     124.461us      62.231us       0.000us         0.00%       0.000us       0.000us             2  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  aten::lt         0.00%      81.023us         0.00%     139.984us     139.984us       0.000us         0.00%       0.000us       0.000us             1  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          aten::is_nonzero         0.00%       3.741us         0.00%      10.919us      10.919us       0.000us         0.00%       0.000us       0.000us             1  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           aten::ones_like         0.00%       2.888ms         0.04%      32.089ms      80.222us       0.000us         0.00%     757.900us       1.895us           400  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         autograd::engine::evaluate_function: DivBackward0         0.01%       7.852ms         0.05%      37.400ms      93.500us       0.000us         0.00%     815.386us       2.038us           400  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              DivBackward0         0.01%       4.543ms         0.04%      29.548ms      73.871us       0.000us         0.00%     815.386us       2.038us           400  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     autograd::engine::evaluate_function: NllLossBackward0         0.01%       8.497ms         0.08%      60.654ms     151.634us       0.000us         0.00%        1.951s       4.877ms           400  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          NllLossBackward0         0.00%       3.721ms         0.07%      52.157ms     130.391us       0.000us         0.00%        1.951s       4.877ms           400  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      autograd::engine::evaluate_function: ToCopyBackward0         0.36%     277.794ms        13.45%       10.521s     350.716us       0.000us         0.00%        5.297s     176.578us         30000  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ToCopyBackward0         0.12%      95.700ms        13.10%       10.244s     341.456us       0.000us         0.00%        5.297s     176.578us         30000  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  autograd::engine::evaluate_function: LogSoftmaxBackward0         0.01%       3.936ms         0.02%      18.155ms      45.387us       0.000us         0.00%        3.872s       9.680ms           400  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       LogSoftmaxBackward0         0.00%       3.373ms         0.02%      14.219ms      35.547us       0.000us         0.00%        3.872s       9.680ms           400  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        autograd::engine::evaluate_function: ViewBackward0         0.34%     266.146ms         0.78%     612.554ms      15.626us       0.000us         0.00%       0.000us       0.000us         39200  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ViewBackward0         0.16%     127.863ms         0.44%     346.408ms       8.837us       0.000us         0.00%       0.000us       0.000us         39200  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  autograd::engine::evaluate_function: UnsafeViewBackward0         0.17%     131.522ms         0.42%     328.822ms      16.777us       0.000us         0.00%       0.000us       0.000us         19600  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       UnsafeViewBackward0         0.09%      70.541ms         0.25%     197.300ms      10.066us       0.000us         0.00%       0.000us       0.000us         19600  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          autograd::engine::evaluate_function: MmBackward0         0.44%     343.140ms        31.06%       24.291s       1.239ms       0.000us         0.00%       24.470s       1.248ms         19600  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               MmBackward0         0.41%     319.988ms        30.62%       23.948s       1.222ms       0.000us         0.00%       24.470s       1.248ms         19600  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           cudaMemsetAsync        10.30%        8.055s        10.30%        8.055s     428.437us       0.000us         0.00%       0.000us       0.000us         18800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           autograd::engine::evaluate_function: TBackward0         0.16%     129.043ms         0.41%     323.766ms      16.519us       0.000us         0.00%       0.000us       0.000us         19600  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                TBackward0         0.05%      41.121ms         0.25%     194.723ms       9.935us       0.000us         0.00%       0.000us       0.000us         19600  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             autograd::engine::evaluate_function: NativeLayerNormBackward0         0.37%     285.636ms         5.89%        4.605s     460.529us       0.000us         0.00%        6.652s     665.162us         10000  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  NativeLayerNormBackward0         0.13%     103.018ms         3.82%        2.991s     299.113us       0.000us         0.00%        4.655s     465.505us         10000  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      autograd::engine::evaluate_function: torch::autograd::AccumulateGrad         0.25%     194.351ms        12.71%        9.944s     331.454us       0.000us         0.00%     399.965ms      13.332us         30000  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           torch::autograd::AccumulateGrad         0.26%     201.409ms        12.47%        9.749s     324.976us       0.000us         0.00%     399.965ms      13.332us         30000  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              aten::detach         0.00%       1.526ms         0.01%       4.426ms       5.901us       0.000us         0.00%       0.000us       0.000us           750  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    detach         0.00%       2.900ms         0.00%       2.900ms       3.867us       0.000us         0.00%       0.000us       0.000us           750  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         autograd::engine::evaluate_function: AddBackward0         0.15%     119.617ms         2.39%        1.867s     186.748us       0.000us         0.00%        1.402s     140.207us         10000  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              AddBackward0         0.02%      14.569ms         0.02%      14.569ms       1.457us       0.000us         0.00%       0.000us       0.000us         10000  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        autograd::engine::evaluate_function: GeluBackward0         0.09%      72.406ms         2.04%        1.594s     332.184us       0.000us         0.00%        2.186s     455.405us          4800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             GeluBackward0         0.04%      29.001ms         1.95%        1.522s     317.099us       0.000us         0.00%        2.186s     455.405us          4800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   autograd::engine::evaluate_function: TransposeBackward0         0.17%     130.695ms         0.35%     277.489ms      14.453us       0.000us         0.00%       0.000us       0.000us         19200  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        TransposeBackward0         0.05%      38.486ms         0.19%     146.794ms       7.646us       0.000us         0.00%       0.000us       0.000us         19200  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              autograd::engine::evaluate_function: ScaledDotProductFlashAttentionBackward0         0.15%     117.853ms         3.06%        2.395s     498.937us       0.000us         0.00%        4.591s     956.423us          4800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ScaledDotProductFlashAttentionBackward0         0.08%      61.477ms         2.91%        2.277s     474.385us       0.000us         0.00%        4.591s     956.423us          4800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        aten::_scaled_dot_product_flash_attention_backward         0.17%     133.442ms         2.83%        2.216s     461.577us       0.000us         0.00%        4.591s     956.423us          4800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       autograd::engine::evaluate_function: SplitBackward0         0.07%      52.533ms         1.35%        1.058s     220.489us       0.000us         0.00%        1.734s     361.247us          4800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            SplitBackward0         0.04%      30.860ms         1.29%        1.006s     209.544us       0.000us         0.00%        1.734s     361.247us          4800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   autograd::engine::evaluate_function: EmbeddingBackward0         0.02%      18.100ms         3.73%        2.917s       3.646ms       0.000us         0.00%     466.739ms     583.424us           800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        EmbeddingBackward0         0.01%       4.521ms         3.65%        2.852s       3.565ms       0.000us         0.00%     335.267ms     419.083us           800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  aten::embedding_backward         0.00%       3.389ms         3.64%        2.847s       3.559ms       0.000us         0.00%     335.267ms     419.083us           800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        cudaGetDeviceCount         0.00%       0.188us         0.00%       0.188us       0.188us       0.000us         0.00%       0.000us       0.000us             1  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     cudaFuncGetAttributes         0.00%      49.021us         0.00%      49.021us      49.021us       0.000us         0.00%       0.000us       0.000us             1  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags         0.04%      30.437ms         0.04%      30.437ms      38.047us       0.000us         0.00%       0.000us       0.000us           800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       cudaPeekAtLastError         0.00%       1.384ms         0.00%       1.384ms       0.204us       0.000us         0.00%       0.000us       0.000us          6800  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           aten::unsqueeze         0.00%       1.544ms         0.00%       2.052ms       2.736us       0.000us         0.00%       0.000us       0.000us           750  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Optimizer.step#AdamW.step         0.01%      11.643ms         0.06%      46.227ms       4.623ms       0.000us         0.00%      28.464ms       2.846ms            10  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          aten::zeros_like         0.00%     490.901us         0.01%       4.138ms      27.588us       0.000us         0.00%     858.266us       5.722us           150  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         aten::result_type         0.00%      95.841us         0.00%      95.841us       0.128us       0.000us         0.00%       0.000us       0.000us           750  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Optimizer.zero_grad#AdamW.zero_grad         0.00%       2.502ms         0.00%       2.502ms     250.198us       0.000us         0.00%       0.000us       0.000us            10  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     cudaDeviceSynchronize         0.34%     262.299ms         0.34%     262.299ms     262.299ms       0.000us         0.00%       0.000us       0.000us             1  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 78.212s
Self CUDA time total: 82.640s
